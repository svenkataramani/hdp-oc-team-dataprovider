#!/bin/sh

kinit -R -k -t /home/hdp_oc_team/kerberos/hdp_oc_team.keytab hdp_oc_team@DC1.CORP.GD
hive -f /home/hdp_oc_team/hivescripts/dataprovider.hql;
hadoop jar ${HOME}/tdch-1.1.1.jar com.teradata.hadoop.tool.TeradataExportTool -classname com.teradata.jdbc.TeraDriver -url jdbc:teradata://godaddy3.prod.phx3.gdg/DATABASE=P_HadoopImp_S -username P_BTCH_HadoopImp -password P_BTCH_HadoopImp -jobtype hdfs -fileformat textfile -method multiple.fastload -batchsize 20000 -separator "|" -sourcepaths /user/hdp_oc_team/hdp_oc_team.db/dataprovider -targettable  DATAPROVIDER_STG  -nullnonstring "\N" -targetfieldnames "shopper_id, domain_id, domain, is_active_flag, request_hostname, request_id, response, hostname, country, region, zip_code, zip_code_quality, city, address, company_name, legal_entity, chamber_of_commerce_number, bank_account_number, iban_number, bic_number, tax_number, phone_number, phone_number_certainty, secondary_phone_numbers, email_addresses, contactable, title, description, keywords, word_count, website_type, category, copyright, vacancies, language, multi_language, authors, pages, pages_indexed, page_types, html_size_kb, date_found, date_analyzed, online_store, ecommerce_certainty, shopping_cart_system, trustmarks, delivery_services, payment_methods, payment_providers, currency, average_price, products, incoming_links, outgoing_links, economic_footprint, site_traffic_estimation, analytics_id, adsense_id, analytics, ad_network, affiliate, social_media_types, social_media_widgets, social_media_profiles, live_chat_software, cms, scripting_language, technical_evaluation, seo_score, seo_summary, flash, rss, login, html_version, generator, mobile_version, mobile_app, maps, libraries, top_level_domain, subdomain, linked_subdomains, linked_subdomains_count, domain_name_length, idn, forwarding_domains, forwarding_domains_count, hosting_country, domain_age_months, ip_address, as_number, as_company, registrar, ns_domain, mx_domain, operating_system, webserver, server_signature, ssl_certificate, ssl_issuer_organization, ssl_issuer_common_name, ssl_type, ssl_start_date, ssl_end_date, ssl_rsa_key_length, status_codes, average_load_time_ms, cdn, video, parking, placeholder, scanrequest_id"; 
bteq -c ASCII < /home/hdp_oc_team/bteqscripts/dataprovider.btq;

